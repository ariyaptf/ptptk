{% extends "coderedcms/pages/pandham.html" %}
{% load i18n crispy_forms_tags static django_htmx wagtailcore_tags %}

{% block content %}
    <div class="container my-5">
        <div class="row">
            <div class="col-md-6 offset-md-3 mt-3">
                <h3>ยืนยันรหัส OTP</h3>
                <div>ที่ส่งไปที่หมายเลขโทรศัพท์ :  {{phone_number}} </div>
                <div class="page-content my-3">
                    <input class="d-none" name="phone_number" value="{{ phone_number }}"></input>
                    <form method="post">
                        {% csrf_token %}
                        {{ form|crispy }}
                        <button type="submit" class="btn btn-primary">ยืนยันรหัส OTP</button>

                        <div class="mt-3 text-center">
                            กรณีที่ยังไม่ได้รับ SMS OTP ให้กดปุ่ม
                            <button
                                type="button" hx-trigger="click"
                                id="resend-otp-btn" class="btn btn-secondary mx-3"
                                hx-get="{% url 'resend_otp' %}"
                                hx-include="[name='phone_number']"
                                hx-target="#resend-otp-result"
                                onclick="startCountdown()"
                            >
                                ขอรหัส OTP
                            </button>
                            <span id="countdown"></span>
                        </div>
                    </form>
                    <div id="resend-otp-result" class="d-none"></div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}


{% block custom_scripts %}
    <script src="{% static 'pandham/js/ConfirmOTP.js' %}"></script>
    <script src="{% static 'website/js/htmx.min.js' %}" defer></script>
    {% django_htmx_script %}
{% endblock %}
